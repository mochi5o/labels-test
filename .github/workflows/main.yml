name: labels-actions
on:
  issues:
    types:
      ['labeled', 'unlabeled']

jobs:
  labeled-actions:
    runs-on: ubuntu-latest
    if: |
      (github.event.label.name == '対応中') || (github.event.label.name == '依頼中')
    name: Recording label's add or remove time
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: POST Comment
        env:
          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          ISSUE_URL: ${{ github.event.issue.url }}
          ISSUE_TITLE: ${{ github.event.issue.title }}
          LABEL_NAME: ${{ github.event.label.name }}
          URL: ${{ github.event.issue.url }}
          TITLE: ${{ github.event.issue.title }}
          DATABASE_ID: ${{ secrets.DATABASE_ID }}
          TOKEN: ${{ secrets.MY_NOTION_TOKEN }}
        run: |
          # curl -X POST -H "Authorization: token $GITHUB_TOKEN" -d "{\"body\": \"Actions:シートに追加しました\"}" $URL
          curl -X POST "https://api.notion.com/v1/pages" \
            -H "Authorization: Bearer $TOKEN" \
            -H "Content-Type: application/json" \
            -H "Notion-Version: 2021-05-13" \
            --data "{\"parent\": { \"database_id\": \"$DATABASE_ID\" },\"properties\": {\"Name\": {\"title\": [{\"text\": {\"content\": \"$ISSUE_TITLE\"}}]},}}"
          # curl -X POST -H "Content-Type: application/json" -d "{\"url\": \"$URL\", \"title\": \"$TITLE\"}" -L ${{ secrets.SPREAD_SHEET }}
